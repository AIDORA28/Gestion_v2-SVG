<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agregar Datos de Prueba - PLANIFICAPRO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body class="bg-gray-50 min-h-screen">
    
    <div class="max-w-4xl mx-auto py-12 px-4">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">üß™ Generador de Datos de Prueba</h1>
            <p class="text-gray-600">Para usuario: <strong>joegarcia.1395@gmail.com</strong></p>
        </div>

        <!-- Status -->
        <div id="status" class="mb-6 p-4 rounded-lg bg-blue-50 border border-blue-200">
            <p class="text-blue-800">‚ú® Listo para agregar datos de prueba</p>
        </div>

        <!-- Preview de datos -->
        <div class="grid md:grid-cols-3 gap-6 mb-8">
            
            <!-- Ingresos -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center mb-4">
                    <i data-lucide="trending-up" class="h-6 w-6 text-green-600 mr-2"></i>
                    <h3 class="text-lg font-semibold text-gray-900">Ingresos</h3>
                </div>
                <p class="text-2xl font-bold text-green-600 mb-2">$7,950.00</p>
                <p class="text-sm text-gray-500">5 registros</p>
                <div class="mt-3 text-xs text-gray-400">
                    ‚Ä¢ Salarios<br>
                    ‚Ä¢ Freelance<br>
                    ‚Ä¢ Ventas
                </div>
            </div>

            <!-- Gastos -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center mb-4">
                    <i data-lucide="trending-down" class="h-6 w-6 text-red-600 mr-2"></i>
                    <h3 class="text-lg font-semibold text-gray-900">Gastos</h3>
                </div>
                <p class="text-2xl font-bold text-red-600 mb-2">$3,150.00</p>
                <p class="text-sm text-gray-500">11 registros</p>
                <div class="mt-3 text-xs text-gray-400">
                    ‚Ä¢ Vivienda<br>
                    ‚Ä¢ Alimentaci√≥n<br>
                    ‚Ä¢ Servicios<br>
                    ‚Ä¢ Transporte
                </div>
            </div>

            <!-- Balance -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex items-center mb-4">
                    <i data-lucide="balance-scale" class="h-6 w-6 text-blue-600 mr-2"></i>
                    <h3 class="text-lg font-semibold text-gray-900">Balance</h3>
                </div>
                <p class="text-2xl font-bold text-green-600 mb-2">+$4,800.00</p>
                <p class="text-sm text-gray-500">Proyectado</p>
                <div class="mt-3 text-xs text-gray-400">
                    Incluye datos de<br>
                    Sep 2025 y Ago 2025
                </div>
            </div>
        </div>

        <!-- Bot√≥n de acci√≥n -->
        <div class="text-center">
            <button 
                id="generateBtn" 
                class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-8 rounded-lg transition-colors shadow-lg"
            >
                <i data-lucide="plus-circle" class="inline h-5 w-5 mr-2"></i>
                Agregar Datos de Prueba
            </button>
        </div>

        <!-- Log -->
        <div class="mt-8">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">üìã Log de Actividad</h3>
            <div id="log" class="bg-gray-900 text-green-400 p-4 rounded-lg font-mono text-sm h-64 overflow-y-auto">
                <p>Esperando acci√≥n del usuario...</p>
            </div>
        </div>

        <!-- Instrucciones -->
        <div class="mt-8 bg-yellow-50 border border-yellow-200 rounded-lg p-6">
            <h4 class="font-semibold text-yellow-800 mb-2">üìã Instrucciones:</h4>
            <ol class="text-yellow-700 text-sm space-y-1">
                <li>1. Aseg√∫rate de estar conectado a internet</li>
                <li>2. Haz clic en "Agregar Datos de Prueba"</li>
                <li>3. Espera a que se complete el proceso</li>
                <li>4. Ve al dashboard para ver los datos reales</li>
                <li>5. Los datos incluyen ingresos, gastos y cr√©ditos de ejemplo</li>
            </ol>
        </div>

    </div>

    <script>
        // Configuraci√≥n
        const SUPABASE_URL = 'https://lobyofpwqwqsszugdwnw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxvYnlvZnB3cXdxc3N6dWdkd253Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTczMTU4NDIsImV4cCI6MjA3Mjg5MTg0Mn0.QsZ2dIU1iPffRGtHUREQIhQ5--7_w4ANowG0rJ0AtcI';

        // Elementos
        const generateBtn = document.getElementById('generateBtn');
        const statusDiv = document.getElementById('status');
        const logDiv = document.getElementById('log');

        // Funci√≥n para log
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const colors = {
                info: 'text-green-400',
                error: 'text-red-400',
                warning: 'text-yellow-400',
                success: 'text-blue-400'
            };
            
            logDiv.innerHTML += `<p class="${colors[type] || colors.info}">[${timestamp}] ${message}</p>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        // Funci√≥n para actualizar status
        function updateStatus(message, type = 'info') {
            const colors = {
                info: 'bg-blue-50 border-blue-200 text-blue-800',
                success: 'bg-green-50 border-green-200 text-green-800',
                error: 'bg-red-50 border-red-200 text-red-800',
                loading: 'bg-yellow-50 border-yellow-200 text-yellow-800'
            };
            
            statusDiv.className = `mb-6 p-4 rounded-lg border ${colors[type] || colors.info}`;
            statusDiv.innerHTML = `<p>${message}</p>`;
        }

        // Datos de prueba
        const DATOS_INGRESOS = [
            { monto: 3500.00, descripcion: 'Salario Quincenal', categoria: 'Salario', fecha_transaccion: '2025-09-01' },
            { monto: 500.00, descripcion: 'Freelance Desarrollo Web', categoria: 'Freelance', fecha_transaccion: '2025-09-05' },
            { monto: 200.00, descripcion: 'Venta Art√≠culos Usados', categoria: 'Ventas', fecha_transaccion: '2025-09-07' },
            { monto: 3500.00, descripcion: 'Salario Quincenal', categoria: 'Salario', fecha_transaccion: '2025-08-15' },
            { monto: 750.00, descripcion: 'Proyecto Consultor√≠a', categoria: 'Freelance', fecha_transaccion: '2025-08-20' }
        ];

        const DATOS_GASTOS = [
            { monto: 800.00, descripcion: 'Renta Departamento', categoria: 'Vivienda', fecha_transaccion: '2025-09-01' },
            { monto: 150.00, descripcion: 'Supermercado Semanal', categoria: 'Alimentaci√≥n', fecha_transaccion: '2025-09-02' },
            { monto: 50.00, descripcion: 'Gasolina', categoria: 'Transporte', fecha_transaccion: '2025-09-03' },
            { monto: 120.00, descripcion: 'Luz y Agua', categoria: 'Servicios', fecha_transaccion: '2025-09-05' },
            { monto: 80.00, descripcion: 'Internet y Tel√©fono', categoria: 'Servicios', fecha_transaccion: '2025-09-05' },
            { monto: 200.00, descripcion: 'Supermercado Mensual', categoria: 'Alimentaci√≥n', fecha_transaccion: '2025-09-08' },
            { monto: 100.00, descripcion: 'Cine y Cena', categoria: 'Entretenimiento', fecha_transaccion: '2025-09-06' },
            { monto: 300.00, descripcion: 'Ropa Nueva', categoria: 'Vestimenta', fecha_transaccion: '2025-09-07' },
            { monto: 800.00, descripcion: 'Renta Departamento', categoria: 'Vivienda', fecha_transaccion: '2025-08-01' },
            { monto: 400.00, descripcion: 'Supermercado Agosto', categoria: 'Alimentaci√≥n', fecha_transaccion: '2025-08-10' },
            { monto: 150.00, descripcion: 'Servicios Agosto', categoria: 'Servicios', fecha_transaccion: '2025-08-15' }
        ];

        const DATOS_CREDITOS = [
            { monto: 10000.00, descripcion: 'Pr√©stamo Personal Banco', tasa_interes: 12.5, plazo_meses: 24, fecha_inicio: '2025-01-15' },
            { monto: 5000.00, descripcion: 'Tarjeta de Cr√©dito', tasa_interes: 18.0, plazo_meses: 12, fecha_inicio: '2025-06-01' }
        ];

        // Funci√≥n principal
        async function agregarDatosPrueba() {
            try {
                generateBtn.disabled = true;
                generateBtn.innerHTML = '<div class="animate-spin inline-block w-4 h-4 border-2 border-white border-t-transparent rounded-full mr-2"></div>Procesando...';
                
                updateStatus('üîÑ Iniciando proceso...', 'loading');
                addLog('üß™ Iniciando inserci√≥n de datos de prueba...');
                
                // Crear cliente Supabase
                const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                
                // Login
                addLog('üîê Haciendo login como Joe...');
                const { data: authData, error: authError } = await supabaseClient.auth.signInWithPassword({
                    email: 'joegarcia.1395@gmail.com',
                    password: '123456'
                });
                
                if (authError) {
                    throw new Error(`Error de autenticaci√≥n: ${authError.message}`);
                }
                
                const userId = authData.user.id;
                addLog(`‚úÖ Login exitoso. User ID: ${userId}`, 'success');
                
                // Insertar ingresos
                addLog('üí∞ Insertando ingresos...');
                updateStatus('üí∞ Insertando ingresos...', 'loading');
                
                const ingresosConUserId = DATOS_INGRESOS.map(ingreso => ({
                    ...ingreso,
                    usuario_id: userId
                }));
                
                const { error: ingresosError } = await supabaseClient
                    .from('ingresos')
                    .insert(ingresosConUserId);
                    
                if (ingresosError) {
                    addLog(`‚ùå Error insertando ingresos: ${ingresosError.message}`, 'error');
                } else {
                    addLog(`‚úÖ Ingresos insertados: ${DATOS_INGRESOS.length}`, 'success');
                }
                
                // Insertar gastos
                addLog('üí∏ Insertando gastos...');
                updateStatus('üí∏ Insertando gastos...', 'loading');
                
                const gastosConUserId = DATOS_GASTOS.map(gasto => ({
                    ...gasto,
                    usuario_id: userId
                }));
                
                const { error: gastosError } = await supabaseClient
                    .from('gastos')
                    .insert(gastosConUserId);
                    
                if (gastosError) {
                    addLog(`‚ùå Error insertando gastos: ${gastosError.message}`, 'error');
                } else {
                    addLog(`‚úÖ Gastos insertados: ${DATOS_GASTOS.length}`, 'success');
                }
                
                // Insertar cr√©ditos
                addLog('üí≥ Insertando cr√©ditos...');
                updateStatus('üí≥ Insertando cr√©ditos...', 'loading');
                
                const creditosConUserId = DATOS_CREDITOS.map(credito => ({
                    ...credito,
                    usuario_id: userId
                }));
                
                const { error: creditosError } = await supabaseClient
                    .from('creditos')
                    .insert(creditosConUserId);
                    
                if (creditosError) {
                    addLog(`‚ùå Error insertando cr√©ditos: ${creditosError.message}`, 'error');
                } else {
                    addLog(`‚úÖ Cr√©ditos insertados: ${DATOS_CREDITOS.length}`, 'success');
                }
                
                // Resumen
                addLog('');
                addLog('üéâ ¬°DATOS DE PRUEBA INSERTADOS EXITOSAMENTE!', 'success');
                addLog(`üìä Resumen: ${DATOS_INGRESOS.length} ingresos, ${DATOS_GASTOS.length} gastos, ${DATOS_CREDITOS.length} cr√©ditos`);
                
                const totalIngresos = DATOS_INGRESOS.reduce((sum, i) => sum + i.monto, 0);
                const totalGastos = DATOS_GASTOS.reduce((sum, g) => sum + g.monto, 0);
                const balance = totalIngresos - totalGastos;
                
                addLog(`üíπ Totales: Ingresos $${totalIngresos.toFixed(2)}, Gastos $${totalGastos.toFixed(2)}, Balance $${balance.toFixed(2)}`, 'success');
                addLog('');
                addLog('üöÄ Ahora puedes probar el dashboard con datos reales!', 'success');
                
                updateStatus('‚úÖ ¬°Datos insertados exitosamente! Ahora ve al dashboard para verlos.', 'success');
                
                // Cambiar bot√≥n
                generateBtn.innerHTML = '<i data-lucide="check-circle" class="inline h-5 w-5 mr-2"></i>¬°Completado!';
                
            } catch (error) {
                addLog(`üí• Error general: ${error.message}`, 'error');
                updateStatus(`‚ùå Error: ${error.message}`, 'error');
                
                generateBtn.disabled = false;
                generateBtn.innerHTML = '<i data-lucide="plus-circle" class="inline h-5 w-5 mr-2"></i>Agregar Datos de Prueba';
            }
        }

        // Event listeners
        generateBtn.addEventListener('click', agregarDatosPrueba);

        // Inicializar iconos
        document.addEventListener('DOMContentLoaded', () => {
            lucide.createIcons();
            addLog('‚ú® Generador de datos de prueba listo');
        });
    </script>

</body>
</html>
