<!-- MÓDULO DE INGRESOS -->
<div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
    <!-- Header con botón de agregar -->
    <div class="mb-6 flex flex-col sm:flex-row sm:items-center sm:justify-between">
        <div>
            <h1 class="text-2xl font-bold text-gray-900">Gestión de Ingresos</h1>
            <p class="mt-1 text-sm text-gray-500">Administra y registra todos tus ingresos financieros</p>
        </div>
        <div class="mt-4 sm:mt-0">
            <button onclick="openAddIngresoModal()" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200">
                <i data-lucide="plus" class="w-4 h-4 mr-2"></i>
                Nuevo Ingreso
            </button>
        </div>
    </div>

    <!-- Filtros y búsqueda -->
    <div class="bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Buscar</label>
                <div class="relative">
                    <input type="text" id="search-ingresos" placeholder="Buscar ingresos..." class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    <i data-lucide="search" class="absolute left-3 top-2.5 h-4 w-4 text-gray-400"></i>
                </div>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Categoría</label>
                <select id="filter-categoria" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    <option value="">Todas las categorías</option>
                    <option value="salario">Salario</option>
                    <option value="freelance">Freelance</option>
                    <option value="negocio">Negocio</option>
                    <option value="inversiones">Inversiones</option>
                    <option value="bonos">Bonos</option>
                    <option value="comisiones">Comisiones</option>
                    <option value="ventas">Ventas</option>
                    <option value="otros">Otros</option>
                </select>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Fecha desde</label>
                <input type="date" id="filter-fecha-desde" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">Fecha hasta</label>
                <input type="date" id="filter-fecha-hasta" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
            </div>
        </div>
        <div class="mt-4 flex space-x-2">
            <button onclick="applyFilters()" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                <i data-lucide="filter" class="w-4 h-4 mr-2 inline"></i>
                Aplicar Filtros
            </button>
            <button onclick="clearFilters()" class="px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors">
                <i data-lucide="x" class="w-4 h-4 mr-2 inline"></i>
                Limpiar
            </button>
        </div>
    </div>

    <!-- Resumen de ingresos -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
        <div class="bg-gradient-to-r from-green-400 to-green-600 rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-green-100 text-sm">Ingresos del Mes</p>
                    <p id="ingresos-mes-total" class="text-2xl font-bold">$0.00</p>
                </div>
                <i data-lucide="trending-up" class="h-8 w-8 text-green-200"></i>
            </div>
        </div>
        <div class="bg-gradient-to-r from-blue-400 to-blue-600 rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-blue-100 text-sm">Total de Ingresos</p>
                    <p id="ingresos-total" class="text-2xl font-bold">$0.00</p>
                </div>
                <i data-lucide="dollar-sign" class="h-8 w-8 text-blue-200"></i>
            </div>
        </div>
        <div class="bg-gradient-to-r from-purple-400 to-purple-600 rounded-lg p-6 text-white">
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-purple-100 text-sm">Cantidad de Registros</p>
                    <p id="ingresos-cantidad" class="text-2xl font-bold">0</p>
                </div>
                <i data-lucide="hash" class="h-8 w-8 text-purple-200"></i>
            </div>
        </div>
    </div>

    <!-- Vista de tarjetas (móvil) -->
    <div id="ingresos-cards" class="block md:hidden space-y-4 mb-6">
        <!-- Cards will be inserted here -->
    </div>

    <!-- Tabla de ingresos (desktop) -->
    <div class="hidden md:block bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden">
        <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
            <div class="flex items-center justify-between">
                <h3 class="text-lg font-medium text-gray-900">Lista de Ingresos</h3>
                <div class="flex space-x-2">
                    <button onclick="exportIngresos()" class="px-3 py-1 text-sm bg-green-600 text-white rounded hover:bg-green-700 transition-colors">
                        <i data-lucide="download" class="w-4 h-4 mr-1 inline"></i>
                        Exportar
                    </button>
                </div>
            </div>
        </div>
        <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripción</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categoría</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monto</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Recurrente</th>
                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                    </tr>
                </thead>
                <tbody id="ingresos-table-body" class="bg-white divide-y divide-gray-200">
                    <!-- Table rows will be inserted here -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Paginación -->
    <div id="ingresos-pagination" class="mt-6 flex items-center justify-between">
        <div class="text-sm text-gray-700">
            Mostrando <span id="pagination-start">0</span> a <span id="pagination-end">0</span> de <span id="pagination-total">0</span> registros
        </div>
        <div class="flex space-x-2">
            <button id="prev-page" onclick="changePage('prev')" class="px-3 py-2 text-sm bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors disabled:opacity-50" disabled>
                Anterior
            </button>
            <button id="next-page" onclick="changePage('next')" class="px-3 py-2 text-sm bg-gray-300 text-gray-700 rounded hover:bg-gray-400 transition-colors disabled:opacity-50" disabled>
                Siguiente
            </button>
        </div>
    </div>
</div>

<!-- Modal para Agregar/Editar Ingreso -->
<div id="ingreso-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
        <div class="p-6">
            <div class="flex items-center justify-between mb-6">
                <h3 id="ingreso-modal-title" class="text-xl font-semibold text-gray-900">Agregar Nuevo Ingreso</h3>
                <button onclick="closeIngresoModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <i data-lucide="x" class="h-6 w-6"></i>
                </button>
            </div>

            <form id="ingreso-form" class="space-y-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <!-- Descripción -->
                    <div class="md:col-span-2">
                        <label for="ingreso-descripcion" class="block text-sm font-medium text-gray-700 mb-2">
                            Descripción del Ingreso <span class="text-red-500">*</span>
                        </label>
                        <input type="text" id="ingreso-descripcion" name="descripcion" required
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                               placeholder="Ej: Salario enero, Proyecto freelance, Venta producto...">
                    </div>

                    <!-- Monto -->
                    <div>
                        <label for="ingreso-monto" class="block text-sm font-medium text-gray-700 mb-2">
                            Monto <span class="text-red-500">*</span>
                        </label>
                        <div class="relative">
                            <span class="absolute left-3 top-2 text-gray-500">$</span>
                            <input type="number" id="ingreso-monto" name="monto" required min="0" step="0.01"
                                   class="w-full pl-8 pr-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                   placeholder="0.00">
                        </div>
                    </div>

                    <!-- Categoría -->
                    <div>
                        <label for="ingreso-categoria" class="block text-sm font-medium text-gray-700 mb-2">
                            Categoría
                        </label>
                        <select id="ingreso-categoria" name="categoria"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Seleccionar categoría</option>
                            <option value="salario">💼 Salario</option>
                            <option value="freelance">💻 Freelance</option>
                            <option value="negocio">🏢 Negocio</option>
                            <option value="inversiones">📈 Inversiones</option>
                            <option value="bonos">🎁 Bonos</option>
                            <option value="comisiones">💰 Comisiones</option>
                            <option value="ventas">🛒 Ventas</option>
                            <option value="otros">📝 Otros</option>
                        </select>
                    </div>

                    <!-- Fecha -->
                    <div>
                        <label for="ingreso-fecha" class="block text-sm font-medium text-gray-700 mb-2">
                            Fecha
                        </label>
                        <input type="date" id="ingreso-fecha" name="fecha"
                               class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                    </div>

                    <!-- Es Recurrente -->
                    <div>
                        <label class="flex items-center space-x-3">
                            <input type="checkbox" id="ingreso-recurrente" name="es_recurrente"
                                   class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                            <span class="text-sm font-medium text-gray-700">Es recurrente</span>
                        </label>
                        <p class="text-xs text-gray-500 mt-1">Marca si este ingreso se repite regularmente</p>
                    </div>

                    <!-- Frecuencia (solo si es recurrente) -->
                    <div id="frecuencia-container" class="hidden">
                        <label for="ingreso-frecuencia" class="block text-sm font-medium text-gray-700 mb-2">
                            Frecuencia (días)
                        </label>
                        <select id="ingreso-frecuencia" name="frecuencia_dias"
                                class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500">
                            <option value="">Seleccionar frecuencia</option>
                            <option value="7">🗓️ Semanal (7 días)</option>
                            <option value="15">📅 Quincenal (15 días)</option>
                            <option value="30">📆 Mensual (30 días)</option>
                            <option value="90">🗓️ Trimestral (90 días)</option>
                            <option value="365">📅 Anual (365 días)</option>
                        </select>
                    </div>

                    <!-- Notas -->
                    <div class="md:col-span-2">
                        <label for="ingreso-notas" class="block text-sm font-medium text-gray-700 mb-2">
                            Notas adicionales
                        </label>
                        <textarea id="ingreso-notas" name="notas" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                                  placeholder="Información adicional sobre este ingreso..."></textarea>
                    </div>
                </div>

                <!-- Botones -->
                <div class="flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200">
                    <button type="submit" class="flex-1 bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-md hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-all duration-200">
                        <i data-lucide="save" class="w-4 h-4 mr-2 inline"></i>
                        <span id="ingreso-submit-text">Guardar Ingreso</span>
                    </button>
                    <button type="button" onclick="closeIngresoModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors">
                        Cancelar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Modal de Confirmación para Eliminar -->
<div id="delete-ingreso-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-xl max-w-md w-full mx-4 p-6">
        <div class="flex items-center justify-center w-12 h-12 mx-auto bg-red-100 rounded-full mb-4">
            <i data-lucide="trash-2" class="w-6 h-6 text-red-600"></i>
        </div>
        <div class="text-center">
            <h3 class="text-lg font-medium text-gray-900 mb-2">Eliminar Ingreso</h3>
            <p class="text-sm text-gray-500 mb-6">¿Estás seguro de que deseas eliminar este ingreso? Esta acción no se puede deshacer.</p>
            <div class="flex space-x-3">
                <button id="confirm-delete-ingreso" class="flex-1 bg-red-600 text-white py-2 px-4 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500">
                    Eliminar
                </button>
                <button onclick="closeDeleteIngresoModal()" class="flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>
