<!-- 游늵 M칍DULO REPORTES - Template Principal -->
<div class="reportes-container bg-white rounded-lg shadow-sm border border-gray-200 p-6">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
        <div class="flex items-center space-x-3">
            <div class="bg-purple-100 p-2 rounded-lg">
                <i class="fas fa-chart-line text-purple-600 text-xl"></i>
            </div>
            <div>
                <h2 class="text-xl font-bold text-gray-900">Reportes Financieros</h2>
                <p class="text-sm text-gray-600">An치lisis detallado de tus finanzas</p>
            </div>
        </div>
        <div class="flex space-x-2">
            <button onclick="window.reportesModuleHandler && window.reportesModuleHandler.exportarReporte('pdf')" 
                    class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm font-medium">
                <i class="fas fa-file-pdf mr-2"></i>PDF
            </button>
            <button onclick="window.reportesModuleHandler && window.reportesModuleHandler.exportarReporte('excel')" 
                    class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium">
                <i class="fas fa-file-excel mr-2"></i>Excel
            </button>
        </div>
    </div>

    <!-- Filtros de Per칤odo -->
    <div class="mb-6 bg-gray-50 p-4 rounded-lg">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">Per칤odo</label>
                <select id="periodo-select" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500">
                    <option value="mes-actual">Mes Actual</option>
                    <option value="mes-anterior">Mes Anterior</option>
                    <option value="trimestre">칔ltimo Trimestre</option>
                    <option value="a침o">Este A침o</option>
                    <option value="personalizado">Personalizado</option>
                </select>
            </div>
            <div id="fecha-desde-container" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-2">Desde</label>
                <input type="date" id="fecha-desde" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500">
            </div>
            <div id="fecha-hasta-container" class="hidden">
                <label class="block text-sm font-medium text-gray-700 mb-2">Hasta</label>
                <input type="date" id="fecha-hasta" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-purple-500 focus:border-purple-500">
            </div>
            <div class="flex items-end">
                <button onclick="window.reportesModuleHandler && window.reportesModuleHandler.generarReporte()" 
                        class="w-full px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium">
                    <i class="fas fa-sync-alt mr-2"></i>Actualizar
                </button>
            </div>
        </div>
    </div>

    <!-- Resumen Ejecutivo -->
    <div class="mb-8">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">游늶 Resumen Ejecutivo</h3>
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
            <div class="bg-green-50 p-4 rounded-lg border border-green-200">
                <div class="flex items-center">
                    <i class="fas fa-arrow-up text-green-600 text-2xl mr-3"></i>
                    <div>
                        <p class="text-sm text-green-700 font-medium">Total Ingresos</p>
                        <p id="total-ingresos" class="text-xl font-bold text-green-800">S/ 0.00</p>
                    </div>
                </div>
            </div>
            <div class="bg-red-50 p-4 rounded-lg border border-red-200">
                <div class="flex items-center">
                    <i class="fas fa-arrow-down text-red-600 text-2xl mr-3"></i>
                    <div>
                        <p class="text-sm text-red-700 font-medium">Total Gastos</p>
                        <p id="total-gastos" class="text-xl font-bold text-red-800">S/ 0.00</p>
                    </div>
                </div>
            </div>
            <div class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                <div class="flex items-center">
                    <i class="fas fa-balance-scale text-blue-600 text-2xl mr-3"></i>
                    <div>
                        <p class="text-sm text-blue-700 font-medium">Balance Neto</p>
                        <p id="balance-neto" class="text-xl font-bold text-blue-800">S/ 0.00</p>
                    </div>
                </div>
            </div>
            <div class="bg-yellow-50 p-4 rounded-lg border border-yellow-200">
                <div class="flex items-center">
                    <i class="fas fa-credit-card text-yellow-600 text-2xl mr-3"></i>
                    <div>
                        <p class="text-sm text-yellow-700 font-medium">Cr칠ditos Activos</p>
                        <p id="total-creditos" class="text-xl font-bold text-yellow-800">S/ 0.00</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Gr치ficos -->
    <div class="mb-8">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">游늵 An치lisis Gr치fico</h3>
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- Gr치fico de Barras - Ingresos vs Gastos -->
            <div class="bg-white p-4 rounded-lg border border-gray-200">
                <h4 class="text-md font-medium text-gray-800 mb-3">Ingresos vs Gastos (Mensual)</h4>
                <canvas id="chart-ingresos-gastos" width="400" height="200"></canvas>
            </div>
            <!-- Gr치fico Circular - Distribuci칩n de Gastos -->
            <div class="bg-white p-4 rounded-lg border border-gray-200">
                <h4 class="text-md font-medium text-gray-800 mb-3">Distribuci칩n de Gastos por Categor칤a</h4>
                <canvas id="chart-gastos-categoria" width="400" height="200"></canvas>
            </div>
        </div>
    </div>

    <!-- Tablas Detalladas -->
    <div class="mb-8">
        <h3 class="text-lg font-semibold text-gray-900 mb-4">游늶 Detalles por Categor칤a</h3>
        
        <!-- Pesta침as -->
        <div class="border-b border-gray-200 mb-4">
            <nav class="-mb-px flex space-x-8">
                <button onclick="window.reportesModuleHandler && window.reportesModuleHandler.mostrarTab('ingresos')" 
                        id="tab-ingresos" class="tab-button active py-2 px-1 border-b-2 border-purple-500 font-medium text-sm text-purple-600">
                    游눯 Ingresos
                </button>
                <button onclick="window.reportesModuleHandler && window.reportesModuleHandler.mostrarTab('gastos')" 
                        id="tab-gastos" class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    游눶 Gastos
                </button>
                <button onclick="window.reportesModuleHandler && window.reportesModuleHandler.mostrarTab('creditos')" 
                        id="tab-creditos" class="tab-button py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    游눱 Cr칠ditos
                </button>
            </nav>
        </div>

        <!-- Contenido de Pesta침as -->
        <div id="tab-content-ingresos" class="tab-content">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripci칩n</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categor칤a</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monto</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-ingresos" class="bg-white divide-y divide-gray-200">
                        <!-- Contenido din치mico -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="tab-content-gastos" class="tab-content hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Fecha</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripci칩n</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Categor칤a</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monto</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-gastos" class="bg-white divide-y divide-gray-200">
                        <!-- Contenido din치mico -->
                    </tbody>
                </table>
            </div>
        </div>

        <div id="tab-content-creditos" class="tab-content hidden">
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripci칩n</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Monto</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Plazo</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                        </tr>
                    </thead>
                    <tbody id="tabla-creditos" class="bg-white divide-y divide-gray-200">
                        <!-- Contenido din치mico -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Loading State -->
    <div id="reportes-loading" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <div class="bg-white p-6 rounded-lg shadow-xl">
            <div class="flex items-center space-x-3">
                <div class="animate-spin rounded-full h-6 w-6 border-b-2 border-purple-600"></div>
                <p class="text-gray-700">Generando reporte...</p>
            </div>
        </div>
    </div>
</div>

<style>
    .tab-button.active {
        color: #9333ea !important;
        border-color: #9333ea !important;
    }
    
    .tab-content {
        display: block;
    }
    
    .tab-content.hidden {
        display: none;
    }
    
    /* Chart.js responsive */
    canvas {
        max-height: 300px !important;
    }
</style>

<script>
    // Funciones globales para compatibility
    function mostrarTabReportes(tab) {
        if (window.reportesModuleHandler && typeof window.reportesModuleHandler.mostrarTab === 'function') {
            window.reportesModuleHandler.mostrarTab(tab);
        }
    }

    function generarReporteManual() {
        if (window.reportesModuleHandler && typeof window.reportesModuleHandler.generarReporte === 'function') {
            window.reportesModuleHandler.generarReporte();
        }
    }

    // Event listeners para filtros
    document.addEventListener('DOMContentLoaded', function() {
        const periodoSelect = document.getElementById('periodo-select');
        if (periodoSelect) {
            periodoSelect.addEventListener('change', function() {
                const fechaDesdeContainer = document.getElementById('fecha-desde-container');
                const fechaHastaContainer = document.getElementById('fecha-hasta-container');
                
                if (this.value === 'personalizado') {
                    fechaDesdeContainer?.classList.remove('hidden');
                    fechaHastaContainer?.classList.remove('hidden');
                } else {
                    fechaDesdeContainer?.classList.add('hidden');
                    fechaHastaContainer?.classList.add('hidden');
                }
            });
        }
    });

    // Hacer funciones disponibles globalmente
    window.mostrarTabReportes = mostrarTabReportes;
    window.generarReporteManual = generarReporteManual;
</script>
